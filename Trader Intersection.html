<html><head><title>Trader Intersections</title><style>
* { background: black; color: white; font: 16px monospace; }
textarea { width: 90%; height: 24%; }
.sb { border: 1px solid white; cursor: pointer; }
</style><script>
function onFileChangeWant()
 {
 let file = document.getElementById('mywantfile').files[0];
 if (file)
  {
  document.getElementById('filetimewant').innerHTML = (new Date(file.lastModified)).toLocaleString('no-NO');
  let reader = new FileReader();
  reader.onload = function (e)
   {
   document.getElementById('mywantlist').value = e.target.result;
   };
  reader.readAsText(file);
  }//if
 }//onFileChangeWant

function onFileChangeHave()
 {
 let file = document.getElementById('myhavefile').files[0];
 if (file)
  {
  document.getElementById('filetimehave').innerHTML = (new Date(file.lastModified)).toLocaleString('no-NO');
  let reader = new FileReader();
  reader.onload = function (e)
   {
   document.getElementById('myhavelist').value = e.target.result;
   };
  reader.readAsText(file);
  }//if
 }//onFileChangeHave

function computeIntersections()
 {
 let list1 = new Map();
 let intersectionList = new Set();
 for(let value of document.getElementById('mywantlist').value.split('\n'))
  {//note to self and interested readers: /([^0-9a-zA-Z]|[\u0300-\u036F])/g is redundant /([^0-9a-zA-Z])/g filters \u0300 to \u036F
  let key = value.normalize('NFKD').replace(/[^0-9a-zA-Z]/g, '').toLowerCase();
  if(!list1.has(key)) { list1.set(key, value); }//if
  }//for
 for(let value of document.getElementById('traderhavelist').value.split('\n'))
  {
  let key = value.normalize('NFKD').replace(/[^0-9a-zA-Z]/g, '').toLowerCase();
  if(list1.has(key)) { intersectionList.add(list1.get(key)); }//if
  }//for
 document.getElementById('iwanttheyhave').value = [...intersectionList].sort().join('\n');
 list1 = new Map();
 intersectionList = new Set();
 for(let value of document.getElementById('myhavelist').value.split('\n'))
  {//note to self and interested readers: /([^0-9a-zA-Z]|[\u0300-\u036F])/g is redundant /([^0-9a-zA-Z])/g filters \u0300 to \u036F
  let key = value.normalize('NFKD').replace(/[^0-9a-zA-Z]/g, '').toLowerCase();
  if(!list1.has(key)) { list1.set(key, value); }//if
  }//for
 for(let value of document.getElementById('traderwantlist').value.split('\n'))
  {
  let key = value.normalize('NFKD').replace(/[^0-9a-zA-Z]/g, '').toLowerCase();
  if(list1.has(key)) { intersectionList.add(list1.get(key)); }//if
  }//for
 document.getElementById('ihavetheywant').value = [...intersectionList].sort().join('\n');
 }//computeIntersections
</script></head><body>
Load Want File: <input id='mywantfile' type='file' onchange='onFileChangeWant();'/> File Last Changed: <span id='filetimewant'></span>
<p> </p>
Load Have File: <input id='myhavefile' type='file' onchange='onFileChangeHave();'/> File Last Changed: <span id='filetimehave'></span>
<p> </p>
<details><summary>My Want List: (click to show/hide)</summary>
<textarea id='mywantlist'></textarea></details>
<p> </p>
<details><summary>My Have List: (click to show/hide)</summary>
<textarea id='myhavelist'></textarea></details>
<p> </p>
<details open><summary>Trader Have List: (click to show/hide)</summary>
<textarea id='traderhavelist' style='height: 5%'></textarea></details>
<p> </p>
<details open><summary>Trader Want List: (click to show/hide)</summary>
<textarea id='traderwantlist' style='height: 5%'></textarea></details>
<p> </p>
<p><span class='sb' onclick='computeIntersections();'>&nbsp; &nbsp; Press Me! &nbsp; &nbsp; </span></p>
<details open><summary>Games I want from them: (click to show/hide)</summary>
<textarea id='iwanttheyhave'></textarea></details>
<p> </p>
<details open><summary>Games I can offer them: (click to show/hide)</summary>
<textarea id='ihavetheywant'></textarea></details>
</body></html>
